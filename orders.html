<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TechStore - Đơn hàng</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>body { font-family: 'Segoe UI', sans-serif; background-color: #f3f4f6; }</style>
</head>
<body>
    <nav class="bg-white shadow-md sticky top-0 z-50">
        <div class="container mx-auto px-4 flex justify-between items-center h-16">
            <a href="index.html" class="flex items-center gap-2 font-bold text-xl text-gray-800">
                <div class="bg-blue-600 p-2 rounded-lg text-white"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg></div>
                TechStore
            </a>
            <div class="flex items-center space-x-2 md:space-x-4">
                <a href="index.html" class="px-3 py-2 rounded-md font-medium text-sm text-gray-600 hover:bg-gray-100">Sản phẩm</a>
                <a href="cart.html" class="px-3 py-2 rounded-md font-medium text-sm text-gray-600 hover:bg-gray-100 flex gap-1 items-center">
                    Giỏ hàng <span id="cart-badge" class="bg-red-500 text-white text-xs rounded-full px-2 py-0.5 hidden">0</span>
                </a>
                <a href="orders.html" class="px-3 py-2 rounded-md font-medium text-sm text-blue-600 bg-blue-100">Đơn hàng</a>
                <a href="profile.html" class="px-3 py-2 rounded-md font-medium text-sm text-gray-600 hover:bg-gray-100 flex items-center gap-1">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg>
                    <span class="hidden md:inline">Tài khoản</span>
                </a>
            </div>
        </div>
    </nav>

    <main class="container mx-auto px-4 py-8 min-h-screen max-w-4xl">
        <h2 class="text-2xl font-bold mb-6">Lịch sử đơn hàng</h2>
        <div id="orders-list" class="space-y-4"></div>
        <div class="mt-8 text-center">
             <button onclick="clearHistory()" class="text-sm text-red-500 hover:underline">Xóa lịch sử đơn hàng</button>
        </div>
    </main>

    <script>
        const MOCK_ORDERS = [{ id: 1001, date: '2025-11-25', status: 'Hoàn thành', total: 38340000, items: 'iPhone 17 Pro Max (x1)' }];
        let storedOrders = localStorage.getItem('techstore_orders');
        let orders = storedOrders ? JSON.parse(storedOrders) : MOCK_ORDERS;
        if (!storedOrders) localStorage.setItem('techstore_orders', JSON.stringify(orders));
        let cart = JSON.parse(localStorage.getItem('techstore_cart')) || [];

        function init() { renderOrders(); updateBadge(); }
        function formatMoney(n) { return new Intl.NumberFormat('vi-VN', { style: 'currency', currency: 'VND' }).format(n); }

        function renderOrders() {
            const list = document.getElementById('orders-list');
            if (orders.length === 0) {
                list.innerHTML = '<div class="p-8 bg-white rounded text-center text-gray-500">Chưa có đơn hàng nào.</div>';
                return;
            }
            list.innerHTML = orders.map(order => `
                <div class="bg-white rounded-lg shadow p-6 border-l-4 ${order.status === 'Hoàn thành' ? 'border-green-500' : 'border-yellow-500'}">
                    <div class="flex justify-between items-start mb-4">
                        <div>
                            <div class="text-sm text-gray-500">Mã đơn: #${order.id}</div>
                            <div class="text-xs text-gray-400">Ngày: ${order.date}</div>
                        </div>
                        <span class="px-3 py-1 rounded-full text-xs font-medium ${order.status === 'Hoàn thành' ? 'bg-green-100 text-green-800' : 'bg-yellow-100 text-yellow-800'}">${order.status}</span>
                    </div>
                    <div class="text-sm text-gray-600 mb-2">
                        <p class="font-medium text-gray-800">Sản phẩm:</p>
                        <p class="text-gray-500 truncate">${order.items}</p>
                    </div>
                    <div class="text-right pt-2 border-t mt-2">
                        <span class="font-bold text-blue-600">${formatMoney(order.total)}</span>
                    </div>
                </div>
            `).join('');
        }

        function updateBadge() {
            const count = cart.reduce((a, b) => a + b.qty, 0);
            const el = document.getElementById('cart-badge');
            el.innerText = count;
            count > 0 ? el.classList.remove('hidden') : el.classList.add('hidden');
        }

        window.clearHistory = () => {
            if(confirm('Xóa toàn bộ lịch sử?')) {
                localStorage.removeItem('techstore_orders');
                orders = [];
                renderOrders();
            }
        }
        init();
    </script>
</body>
</html>